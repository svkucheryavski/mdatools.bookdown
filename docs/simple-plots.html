<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Simple plots | Getting started with mdatools for R</title>
  <meta name="description" content="This is a user guide for mdatools — R package for preprocessing, exploring and analysis of multivariate data. The package provides methods mostly common for Chemometrics. The general idea of the package is to collect most of the common chemometric methods and give a similar user interface for using them. So if a user knows how to make a model and visualise results for one method, he or she can easily do this for the others." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Simple plots | Getting started with mdatools for R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a user guide for mdatools — R package for preprocessing, exploring and analysis of multivariate data. The package provides methods mostly common for Chemometrics. The general idea of the package is to collect most of the common chemometric methods and give a similar user interface for using them. So if a user knows how to make a model and visualise results for one method, he or she can easily do this for the others." />
  <meta name="github-repo" content="svkucheryavski/mdatools.bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Simple plots | Getting started with mdatools for R" />
  
  <meta name="twitter:description" content="This is a user guide for mdatools — R package for preprocessing, exploring and analysis of multivariate data. The package provides methods mostly common for Chemometrics. The general idea of the package is to collect most of the common chemometric methods and give a similar user interface for using them. So if a user knows how to make a model and visualise results for one method, he or she can easily do this for the others." />
  

<meta name="author" content="Sergey Kucheryavskiy" />


<meta name="date" content="2020-02-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="attributes-and-factors.html"/>
<link rel="next" href="plots-for-groups-of-objects.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="what-is-new.html"><a href="what-is-new.html"><i class="fa fa-check"></i>What is new</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i>Overview</a>
<ul>
<li class="chapter" data-level="" data-path="what-mdatools-can-do.html"><a href="what-mdatools-can-do.html"><i class="fa fa-check"></i>What mdatools can do?</a></li>
<li class="chapter" data-level="" data-path="how-to-install.html"><a href="how-to-install.html"><i class="fa fa-check"></i>How to install</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="datasets-and-plots.html"><a href="datasets-and-plots.html"><i class="fa fa-check"></i>Datasets and plots</a>
<ul>
<li class="chapter" data-level="" data-path="attributes-and-factors.html"><a href="attributes-and-factors.html"><i class="fa fa-check"></i>Attributes and factors</a>
<ul>
<li class="chapter" data-level="" data-path="attributes-and-factors.html"><a href="attributes-and-factors.html#package-specific-attributes"><i class="fa fa-check"></i>Package specific attributes</a></li>
<li class="chapter" data-level="" data-path="attributes-and-factors.html"><a href="attributes-and-factors.html#attributes-for-plots"><i class="fa fa-check"></i>Attributes for plots</a></li>
<li class="chapter" data-level="" data-path="attributes-and-factors.html"><a href="attributes-and-factors.html#special-methods-for-data-transformations"><i class="fa fa-check"></i>Special methods for data transformations</a></li>
<li class="chapter" data-level="" data-path="attributes-and-factors.html"><a href="attributes-and-factors.html#data-frames-with-factors"><i class="fa fa-check"></i>Data frames with factors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="simple-plots.html"><a href="simple-plots.html"><i class="fa fa-check"></i>Simple plots</a>
<ul>
<li class="chapter" data-level="" data-path="simple-plots.html"><a href="simple-plots.html#scatter-plots"><i class="fa fa-check"></i>Scatter plots</a></li>
<li class="chapter" data-level="" data-path="simple-plots.html"><a href="simple-plots.html#line-plots"><i class="fa fa-check"></i>Line plots</a></li>
<li class="chapter" data-level="" data-path="simple-plots.html"><a href="simple-plots.html#bar-and-errorbar-plots"><i class="fa fa-check"></i>Bar and errorbar plots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="plots-for-groups-of-objects.html"><a href="plots-for-groups-of-objects.html"><i class="fa fa-check"></i>Plots for groups of objects</a>
<ul>
<li class="chapter" data-level="" data-path="plots-for-groups-of-objects.html"><a href="plots-for-groups-of-objects.html#one-matrix-or-data-frame"><i class="fa fa-check"></i>One matrix or data frame</a></li>
<li class="chapter" data-level="" data-path="plots-for-groups-of-objects.html"><a href="plots-for-groups-of-objects.html#list-with-matrices-or-data-frames"><i class="fa fa-check"></i>List with matrices or data frames</a></li>
<li class="chapter" data-level="" data-path="plots-for-groups-of-objects.html"><a href="plots-for-groups-of-objects.html#use-factors-to-split-a-dataset-into-groups"><i class="fa fa-check"></i>Use factors to split a dataset into groups</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="working-with-images.html"><a href="working-with-images.html"><i class="fa fa-check"></i>Working with images</a></li>
<li class="chapter" data-level="" data-path="preprocessing.html"><a href="preprocessing.html"><i class="fa fa-check"></i>Preprocessing</a>
<ul>
<li class="chapter" data-level="" data-path="preprocessing.html"><a href="preprocessing.html#autoscaling"><i class="fa fa-check"></i>Autoscaling</a></li>
<li class="chapter" data-level="" data-path="preprocessing.html"><a href="preprocessing.html#correction-of-spectral-baseline"><i class="fa fa-check"></i>Correction of spectral baseline</a></li>
<li class="chapter" data-level="" data-path="preprocessing.html"><a href="preprocessing.html#smoothing-and-derivatives"><i class="fa fa-check"></i>Smoothing and derivatives</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i>Principal component analysis</a>
<ul>
<li class="chapter" data-level="" data-path="models-and-results.html"><a href="models-and-results.html"><i class="fa fa-check"></i>Models and results</a>
<ul>
<li class="chapter" data-level="" data-path="models-and-results.html"><a href="models-and-results.html#model-calibration"><i class="fa fa-check"></i>Model calibration</a></li>
<li class="chapter" data-level="" data-path="models-and-results.html"><a href="models-and-results.html#model-validation"><i class="fa fa-check"></i>Model validation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="plotting-methods.html"><a href="plotting-methods.html"><i class="fa fa-check"></i>Plotting methods</a>
<ul>
<li class="chapter" data-level="" data-path="plotting-methods.html"><a href="plotting-methods.html#support-for-images"><i class="fa fa-check"></i>Support for images</a></li>
<li class="chapter" data-level="" data-path="plotting-methods.html"><a href="plotting-methods.html#manual-x-values-for-loading-line-plot"><i class="fa fa-check"></i>Manual x-values for loading line plot</a></li>
<li class="chapter" data-level="" data-path="plotting-methods.html"><a href="plotting-methods.html#excluding-rows-and-columns"><i class="fa fa-check"></i>Excluding rows and columns</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="residuals-and-critical-limits.html"><a href="residuals-and-critical-limits.html"><i class="fa fa-check"></i>Residuals and critical limits</a>
<ul>
<li class="chapter" data-level="" data-path="residuals-and-critical-limits.html"><a href="residuals-and-critical-limits.html#distance-to-model-and-score-distance"><i class="fa fa-check"></i>Distance to model and score distance</a></li>
<li class="chapter" data-level="" data-path="residuals-and-critical-limits.html"><a href="residuals-and-critical-limits.html#critical-limits"><i class="fa fa-check"></i>Critical limits</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="model-complexity.html"><a href="model-complexity.html"><i class="fa fa-check"></i>Model complexity</a></li>
<li class="chapter" data-level="" data-path="randomized-pca-algorithms.html"><a href="randomized-pca-algorithms.html"><i class="fa fa-check"></i>Randomized PCA algorithms</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="simcadd-simca-classification.html"><a href="simcadd-simca-classification.html"><i class="fa fa-check"></i>SIMCA/DD-SIMCA classification</a>
<ul>
<li class="chapter" data-level="" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html"><i class="fa fa-check"></i>Calibration and validation</a>
<ul>
<li class="chapter" data-level="" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html#cross-validation"><i class="fa fa-check"></i>Cross-validation</a></li>
<li class="chapter" data-level="" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html#predictions-and-validation-with-a-test-set"><i class="fa fa-check"></i>Predictions and validation with a test set</a></li>
<li class="chapter" data-level="" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html#class-belonging-probabilities"><i class="fa fa-check"></i>Class belonging probabilities</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multiclass-classification.html"><a href="multiclass-classification.html"><i class="fa fa-check"></i>Multiclass classification</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="partial-least-squares-regression.html"><a href="partial-least-squares-regression.html"><i class="fa fa-check"></i>Partial least squares regression</a>
<ul>
<li class="chapter" data-level="" data-path="models-and-results-1.html"><a href="models-and-results-1.html"><i class="fa fa-check"></i>Models and results</a>
<ul>
<li class="chapter" data-level="" data-path="models-and-results-1.html"><a href="models-and-results-1.html#model-calibration-1"><i class="fa fa-check"></i>Model calibration</a></li>
<li class="chapter" data-level="" data-path="models-and-results-1.html"><a href="models-and-results-1.html#model-validation-1"><i class="fa fa-check"></i>Model validation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="plotting-methods-1.html"><a href="plotting-methods-1.html"><i class="fa fa-check"></i>Plotting methods</a>
<ul>
<li class="chapter" data-level="" data-path="plotting-methods-1.html"><a href="plotting-methods-1.html#excluding-rows-and-columns-1"><i class="fa fa-check"></i>Excluding rows and columns</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="variable-selection.html"><a href="variable-selection.html"><i class="fa fa-check"></i>Variable selection</a></li>
<li class="chapter" data-level="" data-path="distances-and-outlier-detection.html"><a href="distances-and-outlier-detection.html"><i class="fa fa-check"></i>Distances and outlier detection</a>
<ul>
<li class="chapter" data-level="" data-path="distances-and-outlier-detection.html"><a href="distances-and-outlier-detection.html#residual-distance-for-x-decomposition"><i class="fa fa-check"></i>Residual distance for X-decomposition</a></li>
<li class="chapter" data-level="" data-path="distances-and-outlier-detection.html"><a href="distances-and-outlier-detection.html#residual-distance-for-y-decomposition-and-total-distance"><i class="fa fa-check"></i>Residual distance for Y-decomposition and total distance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="randomization-test.html"><a href="randomization-test.html"><i class="fa fa-check"></i>Randomization test</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pls-discriminant-analysis.html"><a href="pls-discriminant-analysis.html"><i class="fa fa-check"></i>PLS Discriminant Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="calibration-of-pls-da-model.html"><a href="calibration-of-pls-da-model.html"><i class="fa fa-check"></i>Calibration of PLS-DA model</a></li>
<li class="chapter" data-level="" data-path="classification-plots.html"><a href="classification-plots.html"><i class="fa fa-check"></i>Classification plots</a></li>
<li class="chapter" data-level="" data-path="performance-plots.html"><a href="performance-plots.html"><i class="fa fa-check"></i>Performance plots</a></li>
<li class="chapter" data-level="" data-path="predictions-for-a-new-data.html"><a href="predictions-for-a-new-data.html"><i class="fa fa-check"></i>Predictions for a new data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="interval-pls.html"><a href="interval-pls.html"><i class="fa fa-check"></i>Interval PLS</a>
<ul>
<li class="chapter" data-level="" data-path="interval-pls.html"><a href="interval-pls.html#forward-ipls"><i class="fa fa-check"></i>Forward iPLS</a></li>
<li class="chapter" data-level="" data-path="interval-pls.html"><a href="interval-pls.html#backward-ipls"><i class="fa fa-check"></i>Backward iPLS</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Getting started with mdatools for R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-plots" class="section level2">
<h2>Simple plots</h2>
<p>As it was already mentioned, <em>mdatools</em> has its own functions for plotting with several extra options not available in basic plot tools. These functions are used to make all plots in the models and results (e.g. scores, loadings, predictions, etc.) therefore it can be useful to spend some time and learn the new features (e.g. coloring data points with a vector of values or using manual ticks for axes). But if you are going to make all plots manually (e.g. using <em>ggplot2</em>) you can skip this and the next sections.</p>
<p>In this section we will look at how to make simple plots from your data objects. Simple plots are scatter (<code>type = "p"</code>), line (<code>type = "l"</code>), line-scatter (<code>type = "b"</code>), bar (<code>type = "h"</code>)
or errorbar (<code>type = "e"</code>) plots made for a one set of objects. All plots can be created using the same method <code>mdaplot()</code> by providing a whole dataset as a main argument. Depending on a plot type, the method “treats” the data values differently.</p>
<p>This table below contains a list of parameters for <code>mdaplot()</code>, which are not available for traditional R plots. In this section we will describe most of the details using simple examples.</p>
<table>
<colgroup>
<col width="25%" />
<col width="74%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameter</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>cgroup</code></td>
<td align="left">a vector of values (same as number of rows in data) used to colorize plot
objects with a color gradient.</td>
</tr>
<tr class="even">
<td align="left"><code>colmap</code></td>
<td align="left">color map for the color gradient (possible values are <code>'default'</code>, <code>'gray'</code>
or a vector with colors).</td>
</tr>
<tr class="odd">
<td align="left"><code>show.colorbar</code></td>
<td align="left">when color grouping is used, <code>mdaplot()</code> shows a color bar legend, this
parameter allows to turn it off.</td>
</tr>
<tr class="even">
<td align="left"><code>show.labels</code></td>
<td align="left">logical parameter showing labels beside plot objects (points, lines, etc).
Size and color of labels can be adjusted using parameters <code>lab.cex</code> and <code>lab.col</code>.</td>
</tr>
<tr class="odd">
<td align="left"><code>labels</code></td>
<td align="left">parameter telling what to use as labels (by default row names, but can also
be indices or manual values).</td>
</tr>
<tr class="even">
<td align="left"><code>lab.col</code></td>
<td align="left">color for the labels.</td>
</tr>
<tr class="odd">
<td align="left"><code>lab.cex</code></td>
<td align="left">font size for the labels (as a scale factor).</td>
</tr>
<tr class="even">
<td align="left"><code>xticks</code></td>
<td align="left">vector with numeric values to show the x-axis ticks at.</td>
</tr>
<tr class="odd">
<td align="left"><code>yticks</code></td>
<td align="left">vector with numeric values to show the y-axis ticks at.</td>
</tr>
<tr class="even">
<td align="left"><code>xticklabels</code></td>
<td align="left">vector with labels (numbers or text) for the x-ticks.</td>
</tr>
<tr class="odd">
<td align="left"><code>yticklabels</code></td>
<td align="left">vector with labels (numbers or text) for the y-ticks.</td>
</tr>
<tr class="even">
<td align="left"><code>xlas</code></td>
<td align="left">an integer between 0 and 3 telling at which angle the x-tick labels
have to be shown.</td>
</tr>
<tr class="odd">
<td align="left"><code>ylas</code></td>
<td align="left">an integer between 0 and 3 telling at which angle the y-tick labels have
to be shown.</td>
</tr>
<tr class="even">
<td align="left"><code>show.axes</code></td>
<td align="left">logical, if <code>TRUE</code>, function will make a new plot, if <code>FALSE</code>, add the plot
objects to a previous one.</td>
</tr>
<tr class="odd">
<td align="left"><code>show.lines</code></td>
<td align="left">a vector with two numbers — position of horizontal and vertical lines on a
plot (e.g. coordinate axes).</td>
</tr>
<tr class="even">
<td align="left"><code>show.grid</code></td>
<td align="left">logical, show or not a grid. It places grid behind the plot object in contrast
to conventional <code>grid()</code> method. Use <code>grid.lwd</code> and <code>grid.col</code> parameters to
adjust the grid look.</td>
</tr>
<tr class="odd">
<td align="left"><code>show.excluded</code></td>
<td align="left">logical, show or not points or lines corresponded to the excluded rows.</td>
</tr>
<tr class="even">
<td align="left"><code>opacity</code></td>
<td align="left">opacity of colors in range 0…1 (applied to all colors of current plot).</td>
</tr>
</tbody>
</table>
<div id="scatter-plots" class="section level3">
<h3>Scatter plots</h3>
<p>We will use <code>people</code> dataset for illustration how scatter plots work (see <code>?people</code> for details).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="simple-plots.html#cb13-1"></a><span class="kw">data</span>(people)</span>
<span id="cb13-2"><a href="simple-plots.html#cb13-2"></a><span class="kw">attr</span>(people, <span class="st">&quot;name&quot;</span>) &lt;-<span class="st"> &quot;People&quot;</span></span>
<span id="cb13-3"><a href="simple-plots.html#cb13-3"></a><span class="kw">attr</span>(people, <span class="st">&quot;xaxis.name&quot;</span>) &lt;-<span class="st"> &quot;Variables&quot;</span></span>
<span id="cb13-4"><a href="simple-plots.html#cb13-4"></a><span class="kw">attr</span>(people, <span class="st">&quot;yaxis.name&quot;</span>) &lt;-<span class="st"> &quot;Persons&quot;</span></span></code></pre></div>
<p>For scatter plots the method takes first two columns of a dataset as x and y vectors. If only one column is available <code>mdaplot()</code> uses it for y-values and generate x-values as an index for each value.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="simple-plots.html#cb14-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb14-2"><a href="simple-plots.html#cb14-2"></a><span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>)</span>
<span id="cb14-3"><a href="simple-plots.html#cb14-3"></a><span class="kw">mdaplot</span>(<span class="kw">mda.subset</span>(people, <span class="dt">select =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">7</span>)), <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-10-1.png" width="864" /></p>
<p>All parameters, available for the standard <code>points()</code> method will work with <code>mdaplot()</code> as well. Besides that, you can colorize points according to some values using a color gradient. By default, the gradient is generated using one of the diverging color schemes from <a href="http://colorbrewer2.org">colorbrewer2.org</a>, but this can be changed using parameter <code>colmap</code> as it is shown below.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="simple-plots.html#cb15-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb15-2"><a href="simple-plots.html#cb15-2"></a><span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">cgroup =</span> people[, <span class="st">&quot;Beer&quot;</span>])</span>
<span id="cb15-3"><a href="simple-plots.html#cb15-3"></a><span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">cgroup =</span> people[, <span class="st">&quot;Beer&quot;</span>], <span class="dt">show.colorbar =</span> <span class="ot">FALSE</span>)</span>
<span id="cb15-4"><a href="simple-plots.html#cb15-4"></a><span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">cgroup =</span> people[, <span class="st">&quot;Beer&quot;</span>], <span class="dt">colmap =</span> <span class="st">&quot;gray&quot;</span>)</span>
<span id="cb15-5"><a href="simple-plots.html#cb15-5"></a><span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">cgroup =</span> people[, <span class="st">&quot;Beer&quot;</span>], <span class="dt">colmap =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;green&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-11-1.png" width="864" /></p>
<p>If the vector with values for color grouping is a factor, level labels will be shown on a colorbar legend and there will be a small margin between bars.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="simple-plots.html#cb16-1"></a>g =<span class="st"> </span><span class="kw">factor</span>(people[, <span class="st">&quot;Sex&quot;</span>], <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>))</span>
<span id="cb16-2"><a href="simple-plots.html#cb16-2"></a></span>
<span id="cb16-3"><a href="simple-plots.html#cb16-3"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb16-4"><a href="simple-plots.html#cb16-4"></a><span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">cgroup =</span> g)</span>
<span id="cb16-5"><a href="simple-plots.html#cb16-5"></a><span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">cgroup =</span> g, <span class="dt">colmap =</span> <span class="st">&quot;gray&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-12-1.png" width="864" /></p>
<p>If you use point characters from 21 to 25 (the ones which allow to specify both color of border and
background of the marker symbol) you can use <code>pch.colinv</code> to apply color grouping to background
instead of border. See an example below</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="simple-plots.html#cb17-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb17-2"><a href="simple-plots.html#cb17-2"></a><span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">cgroup =</span> people[, <span class="st">&quot;Beer&quot;</span>], <span class="dt">pch =</span> <span class="dv">21</span>, <span class="dt">bg =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb17-3"><a href="simple-plots.html#cb17-3"></a><span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">cgroup =</span> people[, <span class="st">&quot;Beer&quot;</span>], <span class="dt">pch =</span> <span class="dv">21</span>, <span class="dt">bg =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">pch.colinv =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-13-1.png" width="864" /></p>
<p>Another useful option is adding labels to the data points. By default row names will be taken for the labels but you can specify a parameter <code>labels</code>, which can be either a text (<code>"names"</code> or <code>"indices"</code>) or a vector with values to show as labels. Color and size of the labels can be adjusted.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="simple-plots.html#cb18-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb18-2"><a href="simple-plots.html#cb18-2"></a><span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">show.labels =</span> <span class="ot">TRUE</span>)</span>
<span id="cb18-3"><a href="simple-plots.html#cb18-3"></a><span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">show.labels =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="st">&quot;indices&quot;</span>)</span>
<span id="cb18-4"><a href="simple-plots.html#cb18-4"></a><span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">show.labels =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="st">&quot;names&quot;</span>, <span class="dt">lab.col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lab.cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb18-5"><a href="simple-plots.html#cb18-5"></a><span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">show.labels =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="kw">paste0</span>(<span class="st">&quot;O&quot;</span>, <span class="kw">seq_len</span>(<span class="kw">nrow</span>(people))))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-14-1.png" width="864" /></p>
<p>To avoid any problems with arguments when you make a subset, use <code>mda.subset()</code> instead of the traditional ways. As you can see in the example below, if we take first 16 rows, information about excluded objects (as well as all other uder defined arguments, e.g. <code>"name"</code>) disappear and they are show in the plot as normal. But if we use <code>mda.subset()</code> it will take the subset without excluded rows as it is shown below. The subset can be created using logical expressions as well as indices or names of the rows.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="simple-plots.html#cb19-1"></a>weight =<span class="st"> </span>people[, <span class="st">&quot;Weight&quot;</span>]</span>
<span id="cb19-2"><a href="simple-plots.html#cb19-2"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb19-3"><a href="simple-plots.html#cb19-3"></a><span class="kw">mdaplot</span>(people[<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>, ], <span class="dt">show.labels =</span> <span class="ot">TRUE</span>)</span>
<span id="cb19-4"><a href="simple-plots.html#cb19-4"></a><span class="kw">mdaplot</span>(<span class="kw">mda.subset</span>(people, <span class="dt">subset =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">16</span>), <span class="dt">show.labels =</span> <span class="ot">TRUE</span>)</span>
<span id="cb19-5"><a href="simple-plots.html#cb19-5"></a><span class="kw">mdaplot</span>(<span class="kw">mda.subset</span>(people, <span class="dt">subset =</span> <span class="kw">c</span>(<span class="st">&quot;Lisa&quot;</span>, <span class="st">&quot;Benito&quot;</span>, <span class="st">&quot;Federico&quot;</span>)), <span class="dt">show.labels =</span> <span class="ot">TRUE</span>)</span>
<span id="cb19-6"><a href="simple-plots.html#cb19-6"></a><span class="kw">mdaplot</span>(<span class="kw">mda.subset</span>(people, <span class="dt">subset =</span> weight <span class="op">&gt;</span><span class="st"> </span><span class="dv">70</span>), <span class="dt">show.labels =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-15-1.png" width="864" /></p>
<p>You can also manually specify axis ticks and tick labels. The labels can be rotated using parameters <code>xlas</code> and <code>ylas</code>, see the examples below.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="simple-plots.html#cb20-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb20-2"><a href="simple-plots.html#cb20-2"></a><span class="kw">mdaplot</span>(people, <span class="dt">xticks =</span> <span class="kw">c</span>(<span class="dv">165</span>, <span class="dv">175</span>, <span class="dv">185</span>), <span class="dt">xticklabels =</span> <span class="kw">c</span>(<span class="st">&quot;Small&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Hight&quot;</span>))</span>
<span id="cb20-3"><a href="simple-plots.html#cb20-3"></a><span class="kw">mdaplot</span>(people, <span class="dt">yticks =</span> <span class="kw">c</span>(<span class="dv">55</span>, <span class="dv">70</span>, <span class="dv">85</span>), <span class="dt">yticklabels =</span> <span class="kw">c</span>(<span class="st">&quot;Light&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Heavy&quot;</span>))</span>
<span id="cb20-4"><a href="simple-plots.html#cb20-4"></a><span class="kw">mdaplot</span>(people, <span class="dt">xticks =</span> <span class="kw">c</span>(<span class="dv">165</span>, <span class="dv">175</span>, <span class="dv">185</span>), <span class="dt">xticklabels =</span> <span class="kw">c</span>(<span class="st">&quot;Small&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Hight&quot;</span>), <span class="dt">xlas =</span> <span class="dv">2</span>)</span>
<span id="cb20-5"><a href="simple-plots.html#cb20-5"></a><span class="kw">mdaplot</span>(people, <span class="dt">yticks =</span> <span class="kw">c</span>(<span class="dv">55</span>, <span class="dv">70</span>, <span class="dv">85</span>), <span class="dt">yticklabels =</span> <span class="kw">c</span>(<span class="st">&quot;Light&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Heavy&quot;</span>), <span class="dt">ylas =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-16-1.png" width="864" /></p>
<p>If both axis labels and rotated axis ticks have to be shown, you can adjust plot margins and position of the label using <code>par()</code> function and <code>mtext()</code> for positioning axis label manually.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="simple-plots.html#cb21-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb21-2"><a href="simple-plots.html#cb21-2"></a></span>
<span id="cb21-3"><a href="simple-plots.html#cb21-3"></a><span class="co"># change margin for bottom part</span></span>
<span id="cb21-4"><a href="simple-plots.html#cb21-4"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>)</span>
<span id="cb21-5"><a href="simple-plots.html#cb21-5"></a><span class="kw">mdaplot</span>(people, <span class="dt">xticks =</span> <span class="kw">c</span>(<span class="dv">165</span>, <span class="dv">175</span>, <span class="dv">185</span>), <span class="dt">xticklabels =</span> <span class="kw">c</span>(<span class="st">&quot;Small&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Hight&quot;</span>),</span>
<span id="cb21-6"><a href="simple-plots.html#cb21-6"></a>        <span class="dt">xlas =</span> <span class="dv">2</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb21-7"><a href="simple-plots.html#cb21-7"></a><span class="kw">mtext</span>(<span class="st">&quot;Height&quot;</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="dv">5</span>)</span>
<span id="cb21-8"><a href="simple-plots.html#cb21-8"></a></span>
<span id="cb21-9"><a href="simple-plots.html#cb21-9"></a><span class="co"># change margin for left part</span></span>
<span id="cb21-10"><a href="simple-plots.html#cb21-10"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>)</span>
<span id="cb21-11"><a href="simple-plots.html#cb21-11"></a><span class="kw">mdaplot</span>(people, <span class="dt">yticks =</span> <span class="kw">c</span>(<span class="dv">55</span>, <span class="dv">70</span>, <span class="dv">85</span>), <span class="dt">yticklabels =</span> <span class="kw">c</span>(<span class="st">&quot;Light&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Heavy&quot;</span>),</span>
<span id="cb21-12"><a href="simple-plots.html#cb21-12"></a>        <span class="dt">ylas =</span> <span class="dv">2</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb21-13"><a href="simple-plots.html#cb21-13"></a><span class="kw">mtext</span>(<span class="st">&quot;Weight&quot;</span>, <span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-17-1.png" width="864" /></p>
<p>There is also a couple of other parameters, allowing to show/hide grid as well as show horizontal and vertical lines on the plot (axes limits will be adjusted correspondingly).</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="simple-plots.html#cb22-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb22-2"><a href="simple-plots.html#cb22-2"></a><span class="kw">mdaplot</span>(people, <span class="dt">show.grid =</span> <span class="ot">FALSE</span>, <span class="dt">show.lines =</span> <span class="kw">c</span>(<span class="dv">170</span>, <span class="dv">65</span>))</span>
<span id="cb22-3"><a href="simple-plots.html#cb22-3"></a><span class="kw">mdaplot</span>(people, <span class="dt">show.lines =</span> <span class="kw">c</span>(<span class="dv">220</span>, <span class="ot">NA</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="864" /></p>
<p>From version <em>0.10.0</em> function <code>mdaplot()</code> returns plot series data, which can be used for
extra options. For example, in case of scatter plot you can add confidence ellipse or convex
hull for data points. To do this, points must be color grouped by a factor as shown below. For confidence ellipse you can specify the confidence level (default 0.95).</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="simple-plots.html#cb23-1"></a>g =<span class="st"> </span><span class="kw">factor</span>(people[, <span class="st">&quot;Sex&quot;</span>], <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>))</span>
<span id="cb23-2"><a href="simple-plots.html#cb23-2"></a></span>
<span id="cb23-3"><a href="simple-plots.html#cb23-3"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb23-4"><a href="simple-plots.html#cb23-4"></a>p =<span class="st"> </span><span class="kw">mdaplot</span>(people, <span class="dt">cgroup =</span> g)</span>
<span id="cb23-5"><a href="simple-plots.html#cb23-5"></a><span class="kw">plotConvexHull</span>(p)</span>
<span id="cb23-6"><a href="simple-plots.html#cb23-6"></a>p =<span class="st"> </span><span class="kw">mdaplot</span>(people, <span class="dt">cgroup =</span> g)</span>
<span id="cb23-7"><a href="simple-plots.html#cb23-7"></a><span class="kw">plotConfidenceEllipse</span>(p, <span class="dt">conf.level =</span> <span class="fl">0.90</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-20-1.png" width="864" /></p>
</div>
<div id="line-plots" class="section level3">
<h3>Line plots</h3>
<p>When line plot is created, the <code>mdatools()</code> shows a line plot for every row. So if data set has more than one row, the plot will show a banch of lines having same properties (color, type, etc). This is particularly useful when working with signals and spectroscopic data. In this subsection we will use simulated UV/Vis spectra from <code>simdata</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="simple-plots.html#cb24-1"></a><span class="kw">data</span>(simdata)</span>
<span id="cb24-2"><a href="simple-plots.html#cb24-2"></a>spectra =<span class="st"> </span>simdata<span class="op">$</span>spectra.c</span>
<span id="cb24-3"><a href="simple-plots.html#cb24-3"></a>conc =<span class="st"> </span>simdata<span class="op">$</span>conc.c[, <span class="dv">1</span>]</span>
<span id="cb24-4"><a href="simple-plots.html#cb24-4"></a>wavelength =<span class="st"> </span>simdata<span class="op">$</span>wavelength</span>
<span id="cb24-5"><a href="simple-plots.html#cb24-5"></a></span>
<span id="cb24-6"><a href="simple-plots.html#cb24-6"></a><span class="kw">attr</span>(spectra, <span class="st">&quot;name&quot;</span>) =<span class="st"> &quot;UV/Vis spectra&quot;</span></span>
<span id="cb24-7"><a href="simple-plots.html#cb24-7"></a><span class="kw">attr</span>(spectra, <span class="st">&quot;xaxis.name&quot;</span>) =<span class="st"> &quot;Band index&quot;</span></span></code></pre></div>
<p>Here are simple examples of how to make the line plots.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="simple-plots.html#cb25-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb25-2"><a href="simple-plots.html#cb25-2"></a><span class="kw">mdaplot</span>(spectra, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb25-3"><a href="simple-plots.html#cb25-3"></a><span class="kw">mdaplot</span>(spectra, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;darkgray&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="864" /></p>
<p>Most of the parameters described for scatter plots will work for the line plots as well. For example, you can colorise the lines by using a vector with some values (in the example below I use concentration of one of the chemical components).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="simple-plots.html#cb26-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb26-2"><a href="simple-plots.html#cb26-2"></a><span class="kw">mdaplot</span>(spectra, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">cgroup =</span> conc)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-23-1.png" width="864" /></p>
<p>One of the new features, appeared first in version 0.8.0, is a special attribute, allowing to provide manual x-values — <code>'xaxis.values'</code> (similar parameter for y-values is <code>'yaxis.values'</code>). In the example below we show the spectra using wavelength in nm and wavenumbers in inverse cm.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="simple-plots.html#cb27-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb27-2"><a href="simple-plots.html#cb27-2"></a></span>
<span id="cb27-3"><a href="simple-plots.html#cb27-3"></a><span class="kw">attr</span>(spectra, <span class="st">&quot;xaxis.name&quot;</span>) =<span class="st"> </span><span class="kw">expression</span>(<span class="st">&quot;Wavenumbers, cm&quot;</span><span class="op">^-</span><span class="dv">1</span>)</span>
<span id="cb27-4"><a href="simple-plots.html#cb27-4"></a><span class="kw">attr</span>(spectra, <span class="st">&quot;xaxis.values&quot;</span>) =<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">7</span><span class="op">/</span>wavelength</span>
<span id="cb27-5"><a href="simple-plots.html#cb27-5"></a><span class="kw">mdaplot</span>(spectra, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb27-6"><a href="simple-plots.html#cb27-6"></a></span>
<span id="cb27-7"><a href="simple-plots.html#cb27-7"></a><span class="kw">attr</span>(spectra, <span class="st">&quot;xaxis.name&quot;</span>) =<span class="st"> &quot;Wavelength, nm&quot;</span></span>
<span id="cb27-8"><a href="simple-plots.html#cb27-8"></a><span class="kw">attr</span>(spectra, <span class="st">&quot;xaxis.values&quot;</span>) =<span class="st"> </span>wavelength</span>
<span id="cb27-9"><a href="simple-plots.html#cb27-9"></a><span class="kw">mdaplot</span>(spectra, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="864" /></p>
<p>When you provide such data to any model methods (e.g. PCA, PLS, etc), then all variable related results (loadings, regression coefficients, etc.) will inherit this attribute and use it for making line plots.</p>
</div>
<div id="bar-and-errorbar-plots" class="section level3">
<h3>Bar and errorbar plots</h3>
<p>Bar plot is perhaps the simplest as it shows values for the first row of the data as bars. Let us get back to the people data, calculate mean for all variables and show the calculated values as a bar plot (excluding column with Income as it has much bigger values comparing to the others) — in the simplest form as well as with some extra parameters.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="simple-plots.html#cb28-1"></a>m =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">apply</span>(people, <span class="dv">2</span>, mean), <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb28-2"><a href="simple-plots.html#cb28-2"></a><span class="kw">colnames</span>(m) =<span class="st"> </span><span class="kw">colnames</span>(people)</span>
<span id="cb28-3"><a href="simple-plots.html#cb28-3"></a>m =<span class="st"> </span><span class="kw">mda.exclcols</span>(m, <span class="st">&quot;Income&quot;</span>)</span>
<span id="cb28-4"><a href="simple-plots.html#cb28-4"></a><span class="kw">attr</span>(m, <span class="st">&quot;name&quot;</span>) =<span class="st"> &quot;People (means)&quot;</span></span>
<span id="cb28-5"><a href="simple-plots.html#cb28-5"></a></span>
<span id="cb28-6"><a href="simple-plots.html#cb28-6"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb28-7"><a href="simple-plots.html#cb28-7"></a><span class="kw">mdaplot</span>(m, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb28-8"><a href="simple-plots.html#cb28-8"></a><span class="kw">mdaplot</span>(m, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">xticks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">xticklabels =</span> <span class="kw">colnames</span>(people), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb28-9"><a href="simple-plots.html#cb28-9"></a>   <span class="dt">show.labels =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="st">&quot;values&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="864" /></p>
<p>Errorbar plot always expect data to have two or three rows. The first row is a origin points of the error bars, secod row is the size of the bottom part and the third row is the size of the top part. If data has only two rows the both parts will be symmetric related to the origin. In the example below we show mean and standard deviation of the people data as an error bar.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="simple-plots.html#cb29-1"></a>d =<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">apply</span>(people, <span class="dv">2</span>, mean), <span class="kw">apply</span>(people, <span class="dv">2</span>, sd))</span>
<span id="cb29-2"><a href="simple-plots.html#cb29-2"></a><span class="kw">rownames</span>(d) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Std&quot;</span>)</span>
<span id="cb29-3"><a href="simple-plots.html#cb29-3"></a><span class="kw">colnames</span>(d) =<span class="st"> </span><span class="kw">colnames</span>(people)</span>
<span id="cb29-4"><a href="simple-plots.html#cb29-4"></a><span class="kw">attr</span>(d, <span class="st">&#39;name&#39;</span>) =<span class="st"> &quot;Statistics&quot;</span></span>
<span id="cb29-5"><a href="simple-plots.html#cb29-5"></a>d =<span class="st"> </span><span class="kw">mda.exclcols</span>(d, <span class="st">&quot;Income&quot;</span>)</span>
<span id="cb29-6"><a href="simple-plots.html#cb29-6"></a></span>
<span id="cb29-7"><a href="simple-plots.html#cb29-7"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb29-8"><a href="simple-plots.html#cb29-8"></a><span class="kw">mdaplot</span>(d, <span class="dt">type =</span> <span class="st">&quot;e&quot;</span>)</span>
<span id="cb29-9"><a href="simple-plots.html#cb29-9"></a><span class="kw">mdaplot</span>(d, <span class="dt">type =</span> <span class="st">&quot;e&quot;</span>, <span class="dt">xticks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">xticklabels =</span> <span class="kw">colnames</span>(people), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-26-1.png" width="864" /></p>
<p>All simple plots can be combined together on the same axes. In this case, first plot is created as usual and all other plots have to be created with option <code>show.axes = FALSE</code> as it is shown below. It must be noted that in this case axes limits have to be set manually when creating the first plot.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="simple-plots.html#cb30-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb30-2"><a href="simple-plots.html#cb30-2"></a></span>
<span id="cb30-3"><a href="simple-plots.html#cb30-3"></a><span class="kw">mdaplot</span>(m, <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;lightgray&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">400</span>))</span>
<span id="cb30-4"><a href="simple-plots.html#cb30-4"></a><span class="kw">mdaplot</span>(d, <span class="dt">type =</span> <span class="st">&quot;e&quot;</span>, <span class="dt">show.axes =</span> <span class="ot">FALSE</span>, <span class="dt">pch =</span> <span class="ot">NA</span>)</span>
<span id="cb30-5"><a href="simple-plots.html#cb30-5"></a></span>
<span id="cb30-6"><a href="simple-plots.html#cb30-6"></a><span class="kw">mdaplot</span>(m, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">400</span>))</span>
<span id="cb30-7"><a href="simple-plots.html#cb30-7"></a><span class="kw">mdaplot</span>(d, <span class="dt">type =</span> <span class="st">&quot;e&quot;</span>, <span class="dt">show.axes =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="864" /></p>
<p>In the next section we will discuss plots for several groups of objects (rows).</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="attributes-and-factors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plots-for-groups-of-objects.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 1
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
