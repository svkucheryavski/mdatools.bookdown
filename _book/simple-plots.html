<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Getting started with mdatools for R</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This is a user guide for mdatools — R package for preprocessing, exploring and analysis of multivariate data. The package provides methods mostly common for Chemometrics. The general idea of the package is to collect most of the common chemometric methods and give a similar user interface for using them. So if a user knows how to make a model and visualise results for one method, he or she can easily do this for the others.">
  <meta name="generator" content="bookdown 0.1.4 and GitBook 2.6.7">

  <meta property="og:title" content="Getting started with mdatools for R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a user guide for mdatools — R package for preprocessing, exploring and analysis of multivariate data. The package provides methods mostly common for Chemometrics. The general idea of the package is to collect most of the common chemometric methods and give a similar user interface for using them. So if a user knows how to make a model and visualise results for one method, he or she can easily do this for the others." />
  <meta name="github-repo" content="svkucheryavski/mdatools.bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Getting started with mdatools for R" />
  
  <meta name="twitter:description" content="This is a user guide for mdatools — R package for preprocessing, exploring and analysis of multivariate data. The package provides methods mostly common for Chemometrics. The general idea of the package is to collect most of the common chemometric methods and give a similar user interface for using them. So if a user knows how to make a model and visualise results for one method, he or she can easily do this for the others." />
  

<meta name="author" content="Sergey Kucheryavskiy">

<meta name="date" content="2016-08-16">


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="attributes-and-factors.html">
<link rel="next" href="plots-for-groups-of-objects.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="what-is-new.html"><a href="what-is-new.html"><i class="fa fa-check"></i>What is new</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i>Overview</a><ul>
<li class="chapter" data-level="" data-path="what-mdatools-can-do.html"><a href="what-mdatools-can-do.html"><i class="fa fa-check"></i>What mdatools can do?</a></li>
<li class="chapter" data-level="" data-path="how-to-install.html"><a href="how-to-install.html"><i class="fa fa-check"></i>How to install</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="datasets-and-plots.html"><a href="datasets-and-plots.html"><i class="fa fa-check"></i>Datasets and plots</a><ul>
<li class="chapter" data-level="" data-path="attributes-and-factors.html"><a href="attributes-and-factors.html"><i class="fa fa-check"></i>Attributes and factors</a><ul>
<li class="chapter" data-level="" data-path="attributes-and-factors.html"><a href="attributes-and-factors.html#package-specific-attributes"><i class="fa fa-check"></i>Package specific attributes</a></li>
<li class="chapter" data-level="" data-path="attributes-and-factors.html"><a href="attributes-and-factors.html#attributes-for-plots"><i class="fa fa-check"></i>Attributes for plots</a></li>
<li class="chapter" data-level="" data-path="attributes-and-factors.html"><a href="attributes-and-factors.html#excludinghiding-rows-and-columns"><i class="fa fa-check"></i>Excluding/hiding rows and columns</a></li>
<li class="chapter" data-level="" data-path="attributes-and-factors.html"><a href="attributes-and-factors.html#special-methods-for-data-transformations"><i class="fa fa-check"></i>Special methods for data transformations</a></li>
<li class="chapter" data-level="" data-path="attributes-and-factors.html"><a href="attributes-and-factors.html#data-frames-with-factors"><i class="fa fa-check"></i>Data frames with factors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="simple-plots.html"><a href="simple-plots.html"><i class="fa fa-check"></i>Simple plots</a><ul>
<li class="chapter" data-level="" data-path="simple-plots.html"><a href="simple-plots.html#scatter-plots"><i class="fa fa-check"></i>Scatter plots</a></li>
<li class="chapter" data-level="" data-path="simple-plots.html"><a href="simple-plots.html#line-plots"><i class="fa fa-check"></i>Line plots</a></li>
<li class="chapter" data-level="" data-path="simple-plots.html"><a href="simple-plots.html#bar-and-errorbar-plots"><i class="fa fa-check"></i>Bar and errorbar plots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="plots-for-groups-of-objects.html"><a href="plots-for-groups-of-objects.html"><i class="fa fa-check"></i>Plots for groups of objects</a><ul>
<li class="chapter" data-level="" data-path="plots-for-groups-of-objects.html"><a href="plots-for-groups-of-objects.html#one-matrix-or-data-frame"><i class="fa fa-check"></i>One matrix or data frame</a></li>
<li class="chapter" data-level="" data-path="plots-for-groups-of-objects.html"><a href="plots-for-groups-of-objects.html#list-with-matrices-or-data-frames"><i class="fa fa-check"></i>List with matrices or data frames</a></li>
<li class="chapter" data-level="" data-path="plots-for-groups-of-objects.html"><a href="plots-for-groups-of-objects.html#use-factors-to-split-a-dataset-into-groups"><i class="fa fa-check"></i>Use factors to split a dataset into groups</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="working-with-images.html"><a href="working-with-images.html"><i class="fa fa-check"></i>Working with images</a></li>
<li class="chapter" data-level="" data-path="preprocessing.html"><a href="preprocessing.html"><i class="fa fa-check"></i>Preprocessing</a><ul>
<li class="chapter" data-level="" data-path="preprocessing.html"><a href="preprocessing.html#autoscaling"><i class="fa fa-check"></i>Autoscaling</a></li>
<li class="chapter" data-level="" data-path="preprocessing.html"><a href="preprocessing.html#correction-of-spectral-baseline"><i class="fa fa-check"></i>Correction of spectral baseline</a></li>
<li class="chapter" data-level="" data-path="preprocessing.html"><a href="preprocessing.html#smoothing-and-derivatives"><i class="fa fa-check"></i>Smoothing and derivatives</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i>Principal component analysis</a></li>
<li class="chapter" data-level="" data-path="partial-least-squares.html"><a href="partial-least-squares.html"><i class="fa fa-check"></i>Partial least squares</a></li>
<li class="chapter" data-level="" data-path="simca-classification.html"><a href="simca-classification.html"><i class="fa fa-check"></i>SIMCA classification</a></li>
<li class="chapter" data-level="" data-path="pls-discriminant-analysis.html"><a href="pls-discriminant-analysis.html"><i class="fa fa-check"></i>PLS discriminant analysis</a></li>
<li class="chapter" data-level="" data-path="interval-pls.html"><a href="interval-pls.html"><i class="fa fa-check"></i>Interval PLS</a></li>
<li class="chapter" data-level="" data-path="randomization-test-for-pls.html"><a href="randomization-test-for-pls.html"><i class="fa fa-check"></i>Randomization test for PLS</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Getting started with mdatools for R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-plots" class="section level2 unnumbered">
<h2>Simple plots</h2>
<p>As it was already mentioned, <em>mdatools</em> has its own functions for plotting with several extra options not available in basic plot tools. These functions are used to make all plots in the models and results (e.g. scores, loadings, predictions, etc.) therefore it can be useful to spend some time and learn the new features (e.g. coloring data points with a vector of values or using manual ticks for axes). But if you are going to make all plots manually (e.g. using <em>ggplot2</em>) you can skip this and the next sections.</p>
<p>In this section we will look at how to make simple plots from your data objects. Simple plots are scatter (<code>type = 'p'</code>), line (<code>type = 'l'</code>), line-scatter (<code>type = 'b'</code>), bar (<code>type = 'h'</code>) or errorbar (<code>type = 'e'</code>) plots made for a one set of objects. All plots can be created using the same method <code>mdaplot()</code> by providing a whole dataset as a main argument. Depending on a plot type, the method “treats” the data values differently.</p>
<p>This table below contains a list of parameters for <code>mdaplot()</code>, which are not available for traditional R plots. In this section we will describe most of the details using simple examples.</p>
<table>
<colgroup>
<col width="28%" />
<col width="71%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameter</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>cgroup</code></td>
<td align="left">a vector of values (same as number of rows in data) used to colorize plot objects with a color gradient</td>
</tr>
<tr class="even">
<td align="left"><code>colmap</code></td>
<td align="left">colormap for the color gradient (possible values are <code>'default'</code>, <code>'gray'</code> or a vector with colors)</td>
</tr>
<tr class="odd">
<td align="left"><code>show.colorbar</code></td>
<td align="left">when color grouping is used, <code>mdaplot()</code> shows a colorbar legend, this parameter allows to turn it off</td>
</tr>
<tr class="even">
<td align="left"><code>show.labels</code></td>
<td align="left">logical parameter showing labels beside plot objects (points, lines, bars, etc).</td>
</tr>
<tr class="odd">
<td align="left"><code>labels</code></td>
<td align="left">parameter telling what to use as labels (by default row names, but can also be indices or manual values)</td>
</tr>
<tr class="even">
<td align="left"><code>lab.col</code></td>
<td align="left">color for the labels</td>
</tr>
<tr class="odd">
<td align="left"><code>lab.cex</code></td>
<td align="left">font size for the labels (as a scale factor)</td>
</tr>
<tr class="even">
<td align="left"><code>xticks</code></td>
<td align="left">vector with numeric values to show the x-axis ticks at</td>
</tr>
<tr class="odd">
<td align="left"><code>yticks</code></td>
<td align="left">vector with numeric values to show the y-axis ticks at</td>
</tr>
<tr class="even">
<td align="left"><code>xticklabels</code></td>
<td align="left">vector with labels (numbers or text) for the x-ticks</td>
</tr>
<tr class="odd">
<td align="left"><code>yticklabels</code></td>
<td align="left">vector with labels (numbers or text) for the y-ticks</td>
</tr>
<tr class="even">
<td align="left"><code>xlas</code></td>
<td align="left">an integer between 0 and 3 telling at which angle the x-tick labels have to be show</td>
</tr>
<tr class="odd">
<td align="left"><code>ylas</code></td>
<td align="left">an integer between 0 and 3 telling at which angle the y-tick labels have to be show</td>
</tr>
<tr class="even">
<td align="left"><code>show.axes</code></td>
<td align="left">logical, if TRUE, function will make a new plot, if FALSE, add the plot objects to a previous one</td>
</tr>
<tr class="odd">
<td align="left"><code>show.lines</code></td>
<td align="left">a vector with two numbers — position of horizontal and vertical lines on a plot (e.g. coordinate axes)</td>
</tr>
<tr class="even">
<td align="left"><code>show.grid</code></td>
<td align="left">logical, show or not a grid</td>
</tr>
<tr class="odd">
<td align="left"><code>show.excluded</code></td>
<td align="left">logical, show or not objects corresponded to the excluded rows</td>
</tr>
</tbody>
</table>
<div id="scatter-plots" class="section level3 unnumbered">
<h3>Scatter plots</h3>
<p>We will use <code>people</code> dataset for illustration how scatter plots work (see <code>?people</code> for details).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(people)</code></pre></div>
<p>For scatter plots the method takes first two columns of a dataset as x and y vectors. If only one column is available (or data object is a vector), <code>mdaplot()</code> uses it for y-values and generate x-values as an index for each value.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
<span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>)
<span class="kw">mdaplot</span>(people[, <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">7</span>)], <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>)
<span class="kw">mdaplot</span>(people[, <span class="dv">1</span>], <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;Height&#39;</span>)
<span class="kw">mdaplot</span>(people[<span class="dv">1</span>, ], <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;&#39;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-14-1.png" width="864" /></p>
<p>All parameters, available for the standard <code>points()</code> method will work with <code>mdaplot()</code> as well. Besides that, you can colorize points according to some values using a color gradient. By default, the gradient is generated using one of the diverging color schemes from <a href="http://colorbrewer2.org">colorbrewer2.org</a>, but this can be changed using parameter <code>colmap</code> as it is shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
<span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">cgroup =</span> people[, <span class="st">&#39;Beer&#39;</span>])
<span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">cgroup =</span> people[, <span class="st">&#39;Beer&#39;</span>], <span class="dt">show.colorbar =</span> F)
<span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">cgroup =</span> people[, <span class="st">&#39;Beer&#39;</span>], <span class="dt">colmap =</span> <span class="st">&#39;gray&#39;</span>)
<span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">cgroup =</span> people[, <span class="st">&#39;Beer&#39;</span>], <span class="dt">colmap =</span> <span class="kw">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;yellow&#39;</span>, <span class="st">&#39;green&#39;</span>))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-15-1.png" width="864" /></p>
<p>If the vector with values for color grouping is a factor, level labels will be shown on a colorbar legend.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g =<span class="st"> </span><span class="kw">factor</span>(people[, <span class="st">&#39;Sex&#39;</span>], <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;Male&#39;</span>, <span class="st">&#39;Female&#39;</span>))

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">cgroup =</span> g)
<span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">cgroup =</span> g, <span class="dt">colmap =</span> <span class="st">&#39;gray&#39;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-16-1.png" width="864" /></p>
<p>Another useful option is adding labels to the data points. By default row names will be taken for the labels but you can specify a parameter <code>'labels'</code>, which can be either a text (<code>'names'</code> or <code>'indices'</code>) or a vector with values to show as labels. Color and size of the labels can be adjusted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
<span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">show.labels =</span> T)
<span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">show.labels =</span> T, <span class="dt">labels =</span> <span class="st">&#39;indices&#39;</span>)
<span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">show.labels =</span> T, <span class="dt">labels =</span> <span class="st">&#39;names&#39;</span>, <span class="dt">lab.col =</span> <span class="st">&#39;black&#39;</span>, <span class="dt">lab.cex =</span> <span class="dv">1</span>)
<span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">show.labels =</span> T, <span class="dt">labels =</span> <span class="kw">paste</span>(<span class="st">&#39;obj&#39;</span>, <span class="dv">1</span>:<span class="kw">nrow</span>(people)))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-17-1.png" width="864" /></p>
<p>The plots work well with the data attributes (names, axis names, etc.). Excluded rows are not shown until you specify an option <code>show.excluded = TRUE</code>. By the way, if you show labels as indices and some of the rows are hidden, the method takes this into account and shows indices correctly</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attr</span>(people, <span class="st">&#39;name&#39;</span>) =<span class="st"> &#39;People&#39;</span>
<span class="kw">attr</span>(people, <span class="st">&#39;xaxis.name&#39;</span>) =<span class="st"> &#39;Parameters&#39;</span>
people =<span class="st"> </span><span class="kw">mda.exclrows</span>(people, <span class="kw">c</span>(<span class="st">&#39;Lars&#39;</span>, <span class="st">&#39;Mette&#39;</span>, <span class="st">&#39;Gitte&#39;</span>))

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
<span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">show.labels =</span> T)
<span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">show.labels =</span> T, <span class="dt">labels =</span> <span class="st">&#39;indices&#39;</span>)
<span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">show.labels =</span> T, <span class="dt">show.excluded =</span> T)
<span class="kw">mdaplot</span>(people, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">show.labels =</span> T, <span class="dt">show.excluded =</span> T, <span class="dt">labels =</span> <span class="st">&#39;indices&#39;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="864" /></p>
<p>To avoid any problems with arguments when you make a subset, use <code>mda.subset()</code> instead of the traditional ways. As you can see in the example below, if we take first 16 rows, information about excluded objects (as well as all other uder defined arguments, e.g. <code>'name'</code>) disappear and they are show in the plot as normal. But if we use <code>mda.subset()</code> it will take the subset without excluded rows as it is shown below. The subset can be created using logical expressions as well as indices or names of the rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">weight =<span class="st"> </span>people[, <span class="st">&#39;Weight&#39;</span>]
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
<span class="kw">mdaplot</span>(people[<span class="dv">1</span>:<span class="dv">16</span>, ], <span class="dt">show.labels =</span> T, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>)
<span class="kw">mdaplot</span>(<span class="kw">mda.subset</span>(people, <span class="dt">subset =</span> <span class="dv">1</span>:<span class="dv">16</span>), <span class="dt">show.labels =</span> T, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>)
<span class="kw">mdaplot</span>(<span class="kw">mda.subset</span>(people, <span class="dt">subset =</span> <span class="kw">c</span>(<span class="st">&#39;Lisa&#39;</span>, <span class="st">&#39;Benito&#39;</span>, <span class="st">&#39;Federico&#39;</span>)), <span class="dt">show.labels =</span> T, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>)
<span class="kw">mdaplot</span>(<span class="kw">mda.subset</span>(people, <span class="dt">subset =</span> weight &gt;<span class="st"> </span><span class="dv">70</span>), <span class="dt">show.labels =</span> T, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="864" /></p>
<p>You can also manually specify axis ticks and tick labels. The labels can be rotated using parameters <code>xlas</code> and <code>ylas</code>, see the examples below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
<span class="kw">mdaplot</span>(people, <span class="dt">xticks =</span> <span class="kw">c</span>(<span class="dv">165</span>, <span class="dv">175</span>, <span class="dv">185</span>), <span class="dt">xticklabels =</span> <span class="kw">c</span>(<span class="st">&#39;Small&#39;</span>, <span class="st">&#39;Medium&#39;</span>, <span class="st">&#39;Hight&#39;</span>))
<span class="kw">mdaplot</span>(people, <span class="dt">yticks =</span> <span class="kw">c</span>(<span class="dv">55</span>, <span class="dv">70</span>, <span class="dv">85</span>), <span class="dt">yticklabels =</span> <span class="kw">c</span>(<span class="st">&#39;Light&#39;</span>, <span class="st">&#39;Medium&#39;</span>, <span class="st">&#39;Heavy&#39;</span>))
<span class="kw">mdaplot</span>(people, <span class="dt">xticks =</span> <span class="kw">c</span>(<span class="dv">165</span>, <span class="dv">175</span>, <span class="dv">185</span>), <span class="dt">xticklabels =</span> <span class="kw">c</span>(<span class="st">&#39;Small&#39;</span>, <span class="st">&#39;Medium&#39;</span>, <span class="st">&#39;Hight&#39;</span>), <span class="dt">xlas =</span> <span class="dv">2</span>, <span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>)
<span class="kw">mdaplot</span>(people, <span class="dt">yticks =</span> <span class="kw">c</span>(<span class="dv">55</span>, <span class="dv">70</span>, <span class="dv">85</span>), <span class="dt">yticklabels =</span> <span class="kw">c</span>(<span class="st">&#39;Light&#39;</span>, <span class="st">&#39;Medium&#39;</span>, <span class="st">&#39;Heavy&#39;</span>), <span class="dt">ylas =</span> <span class="dv">2</span>, <span class="dt">ylab =</span> <span class="st">&#39;&#39;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-20-1.png" width="864" /></p>
<p>If both axis labels and rotated axis ticks have to be shown, you can adjust plot margins and position of the label using <code>par()</code> function and <code>mtext()</code> for positioning axis label manually.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))

<span class="co"># change margin for bottom part</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>) +<span class="st"> </span><span class="fl">0.1</span>)
<span class="kw">mdaplot</span>(people, <span class="dt">xticks =</span> <span class="kw">c</span>(<span class="dv">165</span>, <span class="dv">175</span>, <span class="dv">185</span>), <span class="dt">xticklabels =</span> <span class="kw">c</span>(<span class="st">&#39;Small&#39;</span>, <span class="st">&#39;Medium&#39;</span>, <span class="st">&#39;Hight&#39;</span>), <span class="dt">xlas =</span> <span class="dv">2</span>, <span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>)
<span class="kw">mtext</span>(<span class="st">&#39;Height&#39;</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="dv">5</span>)

<span class="co"># change margin for left part</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">1</span>) +<span class="st"> </span><span class="fl">0.1</span>)
<span class="kw">mdaplot</span>(people, <span class="dt">yticks =</span> <span class="kw">c</span>(<span class="dv">55</span>, <span class="dv">70</span>, <span class="dv">85</span>), <span class="dt">yticklabels =</span> <span class="kw">c</span>(<span class="st">&#39;Light&#39;</span>, <span class="st">&#39;Medium&#39;</span>, <span class="st">&#39;Heavy&#39;</span>), <span class="dt">ylas =</span> <span class="dv">2</span>, <span class="dt">ylab =</span> <span class="st">&#39;&#39;</span>)
<span class="kw">mtext</span>(<span class="st">&#39;Weight&#39;</span>, <span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">line =</span> <span class="dv">5</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="864" /></p>
<p>There are also a couple of other parameters, allowing to show/hide grid as well as show horizontal and vertical lines on the plot (axes limits will be adjusted correspondingly).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">mdaplot</span>(people, <span class="dt">show.grid =</span> F, <span class="dt">show.lines =</span> <span class="kw">c</span>(<span class="dv">170</span>, <span class="dv">65</span>))
<span class="kw">mdaplot</span>(people, <span class="dt">show.lines =</span> <span class="kw">c</span>(<span class="dv">200</span>, <span class="ot">NA</span>))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-23-1.png" width="864" /></p>
</div>
<div id="line-plots" class="section level3 unnumbered">
<h3>Line plots</h3>
<p>When line plot is created, the <code>mdatools()</code> shows a line plot for every row. So if data set has more than one row, the plot will show a banch of lines having same properties (color, type, etc). This is particularly useful when working with signals and spectroscopic data. In this subsection we will use simulated UV/Vis spectra from <code>simdata</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(simdata)
spectra =<span class="st"> </span>simdata$spectra.c
conc =<span class="st"> </span>simdata$conc.c[, <span class="dv">1</span>]
wavelength =<span class="st"> </span>simdata$wavelength

<span class="kw">attr</span>(spectra, <span class="st">&#39;name&#39;</span>) =<span class="st"> &#39;UV/Vis spectra&#39;</span>
<span class="kw">attr</span>(spectra, <span class="st">&#39;xaxis.name&#39;</span>) =<span class="st"> &#39;Band index&#39;</span></code></pre></div>
<p>Here are simple examples of how to make the line plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))
<span class="kw">mdaplot</span>(spectra, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)
<span class="kw">mdaplot</span>(spectra, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">col =</span> <span class="st">&#39;darkgray&#39;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="864" /></p>
<p>Most of the parameters described for scatter plots will work for the line plots as well. For example, you can colorise the lines by using a vector with some values (in the example below I use concentration of one of the chemical components).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))
<span class="kw">mdaplot</span>(spectra, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">cgroup =</span> conc)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-26-1.png" width="864" /></p>
<p>One of the new features, appeared first in version 0.8.0, is a special attribute, allowing to provide manual x-values — <code>'xaxis.values'</code> (similar parameter for y-values is <code>'yaxis.values'</code>). In the example below we show the spectra using wavelength in nm and wavenumbers in inverse cm.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))

<span class="kw">attr</span>(spectra, <span class="st">&#39;xaxis.name&#39;</span>) =<span class="st"> </span><span class="kw">expression</span>(<span class="st">&#39;Wavenumbers, cm&#39;</span>^-<span class="dv">1</span>)
<span class="kw">attr</span>(spectra, <span class="st">&#39;xaxis.values&#39;</span>) =<span class="st"> </span><span class="dv">10</span>^<span class="dv">7</span>/wavelength
<span class="kw">mdaplot</span>(spectra, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)

<span class="kw">attr</span>(spectra, <span class="st">&#39;xaxis.name&#39;</span>) =<span class="st"> &#39;Wavelength, nm&#39;</span>
<span class="kw">attr</span>(spectra, <span class="st">&#39;xaxis.values&#39;</span>) =<span class="st"> </span>wavelength
<span class="kw">mdaplot</span>(spectra, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="864" /></p>
<p>When you provide such data to any model methods (e.g. PCA, PLS, etc), then all variable related results (loadings, regression coefficients, etc.) will inherit this attribute and use it for making line plots.</p>
<p>Like in scatter plots, the excluded rows will be hidden but you can show them using <code>show.excluded = T</code> parameter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">spectra =<span class="st"> </span><span class="kw">mda.exclrows</span>(spectra, conc &lt;<span class="st"> </span><span class="fl">0.25</span>)

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))
<span class="kw">mdaplot</span>(spectra, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)
<span class="kw">mdaplot</span>(spectra, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">show.excluded =</span> T)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-28-1.png" width="864" /></p>
<p>You can exclude columns as well, however the excluded columns will simply not be shown. If you use manual values for x-axis, the corresponding (hidden) part will be shown just as straight lines so far. I plan to make a more smart processing of hidden columns in next versions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">spectra =<span class="st"> </span><span class="kw">mda.exclcols</span>(spectra, wavelength &gt;<span class="st"> </span><span class="dv">280</span> &amp;<span class="st"> </span>wavelength &lt;<span class="st"> </span><span class="dv">300</span>)

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))
<span class="kw">mdaplot</span>(spectra, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)
<span class="kw">mdaplot</span>(spectra, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">show.excluded =</span> T)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-29-1.png" width="864" /></p>
</div>
<div id="bar-and-errorbar-plots" class="section level3 unnumbered">
<h3>Bar and errorbar plots</h3>
<p>Bar plot is perhaps the simplest as it shows values for the first row of the data as bars. Let us get back to the people data, calculate mean for all variables and show the calculated values as a bar plot (excluding column with Income as it has much bigger values comparing to the others) — in the simplest form as well as with some extra parameters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">apply</span>(people, <span class="dv">2</span>, mean), <span class="dt">nrow =</span> <span class="dv">1</span>)
<span class="kw">colnames</span>(m) =<span class="st"> </span><span class="kw">colnames</span>(people)
m =<span class="st"> </span><span class="kw">mda.exclcols</span>(m, <span class="st">&#39;Income&#39;</span>)

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))
<span class="kw">mdaplot</span>(m, <span class="dt">type =</span> <span class="st">&#39;h&#39;</span>)
<span class="kw">mdaplot</span>(m, <span class="dt">type =</span> <span class="st">&#39;h&#39;</span>, <span class="dt">xticklabels =</span> <span class="kw">colnames</span>(people), <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>, <span class="dt">show.labels =</span> T, <span class="dt">labels =</span> <span class="st">&#39;values&#39;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-1.png" width="864" /></p>
<p>Errorbar plot always expect data to have two or three rows. The first row is a origin points of the error bars, secod row is the size of the bottom part and the third row is the size of the top part. If data has only two rows the both parts will be symmetric related to the origin. In the example below we show mean and standard deviation of the people data as an error bar.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d =<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">apply</span>(people, <span class="dv">2</span>, mean), <span class="kw">apply</span>(people, <span class="dv">2</span>, sd))
<span class="kw">rownames</span>(d) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Mean&#39;</span>, <span class="st">&#39;Std&#39;</span>)
<span class="kw">colnames</span>(d) =<span class="st"> </span><span class="kw">colnames</span>(people)
<span class="kw">attr</span>(d, <span class="st">&#39;name&#39;</span>) =<span class="st"> &#39;Statistics&#39;</span>
d =<span class="st"> </span><span class="kw">mda.exclcols</span>(d, <span class="st">&#39;Income&#39;</span>)

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))
<span class="kw">mdaplot</span>(d, <span class="dt">type =</span> <span class="st">&#39;e&#39;</span>)
<span class="kw">mdaplot</span>(d, <span class="dt">type =</span> <span class="st">&#39;e&#39;</span>, <span class="dt">xticklabels =</span> <span class="kw">colnames</span>(people), <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-31-1.png" width="864" /></p>
<p>All simple plots can be combined together on the same axes. In this case, first plot is created as usual and all other plots have to be created with option <code>show.axes = F</code> as it is shown below. It must be noted that in this case axes limits have to be set manually when creating the first plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))

<span class="kw">mdaplot</span>(m, <span class="dt">type =</span> <span class="st">&#39;h&#39;</span>, <span class="dt">col =</span> <span class="st">&#39;lightgray&#39;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">400</span>))
<span class="kw">mdaplot</span>(d, <span class="dt">type =</span> <span class="st">&#39;e&#39;</span>, <span class="dt">show.axes =</span> F, <span class="dt">pch =</span> <span class="ot">NA</span>)

<span class="kw">mdaplot</span>(m, <span class="dt">type =</span> <span class="st">&#39;b&#39;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">400</span>))
<span class="kw">mdaplot</span>(d, <span class="dt">type =</span> <span class="st">&#39;e&#39;</span>, <span class="dt">show.axes =</span> F)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-32-1.png" width="864" /></p>
<p>In the next section we will discuss plots for several groups of objects (rows).</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="attributes-and-factors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plots-for-groups-of-objects.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 1
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
